<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Formulario de Registro</title>
	<style>
		body {
			margin: 0;
			padding: 0;
			font-family: Arial, sans-serif;
			font-size: 16px;
			line-height: 1.5;
			color: #333;
		}

		header {
			background-color: #007bff;
			color: #fff;
			padding: 10px;
			text-align: center;
			font-weight: bold;
		}

		form {
			max-width: 600px;
			margin: 0 auto;
			padding: 20px;
		}

		label {
			display: block;
			margin-bottom: 10px;
			font-weight: bold;
		}

		input[type="text"] {
			display: block;
			width: 100%;
			padding: 10px;
			font-size: 16px;
			border: 1px solid #ccc;
			border-radius: 4px;
			box-sizing: border-box;
			margin-bottom: 20px;
		}

		input[type="submit"] {
			background-color: #007bff;
			color: #fff;
			border: none;
			padding: 10px 20px;
			font-size: 16px;
			border-radius: 4px;
			cursor: pointer;
		}

		input[type="submit"]:hover {
			background-color: #0062cc;
		}
	</style>
</head>
<body>
	<header>
		<h1>Formulario de Registro</h1>
	</header>

	<form id="registroForm">
		<label for="nombre">Nombre:</label>
		<input type="text" id="nombre" name="nombre" required>

		<label for="apellido">Apellido:</label>
		<input type="text" id="apellido" name="apellido" required>

		<label for="email">Email:</label>
		<input type="text" id="email" name="email" required>

		<input type="submit" value="Enviar">
	</form>

	<script src="https://apis.google.com/js/api.js"></script>
	<script>
		// Cargar la API de Google Sheets
		gapi.load('client', initClient);

		function initClient() {
			// Configurar la API de Google Sheets
			gapi.client.init({
				apiKey: 'TAIzaSyB24jVt7xpL4H9hEKj6bjKSdoAEi7jfseM',
				clientId: '328148101165-54qoittlt7ok52c4pgtp5ahuflod8e6g.apps.googleusercontent.com',
				scope: 'https://www.googleapis.com/auth/spreadsheets',
				discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4']
			}).then(function() {
				// Manejar el envío del formulario
				var form = document.getElementById('registroForm');
				form.addEventListener('submit', handleSubmit);
			});
		}

		function handleSubmit(event) {
			event.preventDefault();

			// Obtener los valores del formulario
			var nombre = document.getElementById('nombre').value;
			var apellido = document.getElementById('apellido').value;
			var email = document.getElementById('email').value;

			// Obtener la hoja de cálculo destino
			// Obtener la hoja de cálculo destino
var spreadsheetId = '1HYkaLe4ke-5BUAfz6Rn-KjBNqh5JbiEtpktXxa2g0N4';
var range = 'Hoja 1';
var sheet = SpreadsheetApp.openById(spreadsheetId).getSheetByName(range);

// Obtener los datos del formulario
function onSubmit(e) {
  var formData = e.values;
  
  // Obtener la fecha y hora actual
  var now = new Date();
  var timestamp = now.toLocaleString();
  
  // Insertar la fila en la hoja de cálculo
  sheet.appendRow([timestamp, formData[1], formData[2], formData[3]]);
}
			// Construir el objeto de datos para enviar a la hoja de cálculo
			var data = [[nombre, apellido, email]];

			// Enviar los datos a la hoja de cálculo
			gapi.client.sheets.spreadsheets.values.append({
				spreadsheetId: 'SPREADSHEET_ID',
				range: 'Hoja 1',
				valueInputOption: 'USER_ENTERED',
				insertDataOption: 'INSERT_ROWS',
				resource: {
					values: data
				}
			}).then(function(response) {
				alert('Datos enviados correctamente');
				form.reset();
			}, function(response) {
				alert('Error al enviar los datos');
			});
		}
	</script>
</body>
</html>